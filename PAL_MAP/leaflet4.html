<!doctype html>
<html lang="en">

<head>
	<meta charset='utf-8' />
	<title>
		Preview
	</title>
  
<link rel="stylesheet" href="leaflet/leaflet.css" />
<link rel="stylesheet" href="style.css" />
<link rel="stylesheet" href="//unpkg.com/github-fork-ribbon-css@0.2.3/gh-fork-ribbon.css"></head>

	
<script src="leaflet/leaflet.js"></script>

<script src="catiline.js"></script>
<script src="leaflet.shpfile.js"></script>

<script src="//unpkg.com/leaflet@1.3.4/dist/leaflet.js"></script>
<script src="leaflet-layerjson.js"></script>
<script src="leaflet.fgdb.js"></script> 
<script src="
https://cdn.jsdelivr.net/npm/leaflet-overpass-layer@2.9.0/dist/OverPassLayer.bundle.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/leaflet-overpass-layer@2.9.0/src/OverPassLayer.min.css" rel="stylesheet">
//<script src="https://unpkg.com/@ngageoint/leaflet-geopackage@3.0.3/dist/leaflet-geopackage.min.js"></script>
<script src="https://unpkg.com/leaflet-kmz@latest/dist/leaflet-kmz.js"></script>


  
	<style>
		html {
			height: 100%
		}

		body {
			height: 100%;
			margin: 0;
			padding: 0;
		}

		#map {
			height: 100%
		}
	</style>
	<link rel="stylesheet" href="gh-pages.css" />
</head>

<body>
	<div class="github-fork-ribbon-wrapper right">
		<div class="github-fork-ribbon">
			<a href="https://github.com/calvinmetcalf/leaflet.shapefile">Fork me on GitHub</a>
		</div>
	</div>
	<div id="map"></div>

	<script>

		const airStrike = L.layerGroup();
		const a1 = L.marker([31.5033, 34.4623]).bindPopup('Church of Saint Porphyrius 19 October 2023, CO.').addTo(airStrike);
		const a2 = L.marker([31.5049, 34.4615]).bindPopup('Al-Ahli Arab Hospital 17 October 2023, CO.').addTo(airStrike);
		const a3 = L.marker([31.4218, 34.3854]).bindPopup('school in the Al-Maghazi refugee camp 17 October 2023, CO.').addTo(airStrike);
	
		const osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
	maxZoom: 22,
	attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
});

		const osmHOT = L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {	maxZoom: 22,	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>'});
		const baseLayers = {	'OpenStreetMap': osm,	'OpenStreetMap.HOT': osmHOT};
		const overlays = {	'AirStrike': airStrike};

	var map = L.map('map', {
			minZoom:8,
			center: [31.4218, 34.3854],
			zoom: 12,
			layers: [osm, airStrike]
		}),
		loader = L.DomUtil.get('loader');

	L.layerJSON({
		url: 'https://overpass-api.de/api/interpreter?data=[out:json];node({lat1},{lon1},{lat2},{lon2})[amenity=hospital];out;',
		propertyItems: 'elements',
		propertyTitle: 'tags.name',
		propertyLoc: ['lat','lon'],
		caching: true,
		cacheId: function(data, latlng) {
			return data.tags.name || latlng.toString();
		},
		buildIcon: function(data, title) {
			
			return new L.Icon({
				iconUrl: 'hospital.jpg',
				iconSize: new L.Point(32, 37),
				iconAnchor: new L.Point(18, 37),
				popupAnchor: new L.Point(0, -37)
			});		},
		buildPopup: function(data, marker) {return data.tags.name || null;		}
	})
	.addTo(map);
	
const layerControl = L.control.layers(baseLayers, overlays).addTo(map);	

		
		//var m = L.map('map').setView([31.5033, 34.462], 8);

		var shpfile = new L.Shapefile('palestiniancommunities_wb_gs.zip', {
			onEachFeature: function(feature, layer) {
				if (feature.properties) {
					layer.bindPopup(Object.keys(feature.properties).map(function(k) {
						return k + ": " + feature.properties[k];
					}).join("<br />"), {
						maxHeight: 200
					});
				}
			}
		});
		shpfile.addTo(map);
		shpfile.once("data:loaded", function() {
			console.log("finished loaded shapefile");
		});
	</script>
</body>

</html>
